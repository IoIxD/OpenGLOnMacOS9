/*	File:		glut_get.c	Contains:		Written by:	Mark J. Kilgard	Mac OS by:	John Stauffer and Geoff Stahl	Copyright:	Copyright © Mark J. Kilgard, 1994.				MacOS portions Copyright © Apple Computer, Inc., 1999	Change History (most recent first):        <6+>    10/17/99    ggs              <6>    10/16/99    ggs     fix return value for GLUT_WINDOW_COLORMAP_SIZE         <5>    10/13/99    ggs              <4>     7/16/99    ggs     Fixed attributions and copyrights         <3>     7/16/99    ggs     Removed fullscreen switches since fullscreen windows are really                                    windows on top of the blanking window         <2>     5/31/99    ggs     remove extranious includes         <1>     5/23/99    GGS     OpenGL glut original source*//* Copyright © Mark J. Kilgard, 1994. *//* This program is freely distributable without licensing fees   and is provided without guarantee or warrantee expressed or   implied. This program is -not- in the public domain. */#include <QDOffscreen.h>#include "glutint.h"#include <stdlib.h>#define GET_CONFIG(attrib)\{\	if(!__glutCurrentWindow)\	{\		__glutWarning("glutGet: no active window");\		return -1;\	}\\	if(__glutCurrentWindow->renderWin == __glutCurrentWindow->win)\	{\		aglDescribePixelFormat(__glutCurrentWindow->vis, attrib, &value);\	}\}int glutGet(GLenum param){	CWindowPtr win;	Rect l_rect, *g_rect;	PixMapHandle pixmap;	GLint x, y, value;	unsigned int width, height;#if TARGET_API_MAC_CARBON	Rect screen_bounds;#endif	switch (param)	{		case GLUT_INIT_WINDOW_X:			return __glutInitX;		case GLUT_INIT_WINDOW_Y:			return __glutInitY;		case GLUT_INIT_WINDOW_WIDTH:			return __glutInitWidth;		case GLUT_INIT_WINDOW_HEIGHT:			return __glutInitHeight;		case GLUT_INIT_DISPLAY_MODE:			return __glutDisplayMode;		case GLUT_WINDOW_X:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}			//			if(__glutCurrentWindow->fullscreen) return 0;						win = __glutCurrentWindow->win;#if TARGET_API_MAC_CARBON			pixmap = GetGWorldPixMap(GetWindowPort(win));#else			pixmap = GetGWorldPixMap(win);#endif			g_rect = &(**pixmap).bounds;			x = -g_rect->left;			return x;		case GLUT_WINDOW_Y:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}			//			if(__glutCurrentWindow->fullscreen) return 0;						win = __glutCurrentWindow->win;#if TARGET_API_MAC_CARBON			pixmap = GetGWorldPixMap(GetWindowPort(win));#else			pixmap = GetGWorldPixMap(win);#endif			g_rect = &(**pixmap).bounds;		//	l_rect = &win->portRect;			// windows are down and right from top left, this is not reqired			y = -g_rect->top;// + l_rect->bottom;			return y;		case GLUT_WINDOW_WIDTH:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}			//			if(__glutCurrentWindow->fullscreen) return __glutCurrentWindow->width;						if(!__glutCurrentWindow->reshape)			{				win = __glutCurrentWindow->win;#if TARGET_API_MAC_CARBON				pixmap = GetGWorldPixMap(GetWindowPort(win));#else				pixmap = GetGWorldPixMap(win);#endif				g_rect = &(**pixmap).bounds;#if TARGET_API_MAC_CARBON				GetWindowPortBounds(__glutCurrentWindow->win, &l_rect);#else				l_rect = __glutCurrentWindow->win->portRect;#endif				width  = l_rect.right;				return width;			}			return __glutCurrentWindow->width;		case GLUT_WINDOW_HEIGHT:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}			//			if(__glutCurrentWindow->fullscreen) return __glutCurrentWindow->height;						if (!__glutCurrentWindow->reshape)			{				win = __glutCurrentWindow->win;#if TARGET_API_MAC_CARBON				pixmap = GetGWorldPixMap(GetWindowPort(win));#else				pixmap = GetGWorldPixMap(win);#endif				g_rect = &(**pixmap).bounds;#if TARGET_API_MAC_CARBON				GetWindowPortBounds(__glutCurrentWindow->win, &l_rect);#else				l_rect = __glutCurrentWindow->win->portRect;#endif				height = l_rect.bottom;				return height;			}			return __glutCurrentWindow->height;		case GLUT_WINDOW_BUFFER_SIZE:			GET_CONFIG(AGL_BUFFER_SIZE);			return value;		case GLUT_WINDOW_STENCIL_SIZE:			GET_CONFIG(AGL_STENCIL_SIZE);			return value;		case GLUT_WINDOW_DEPTH_SIZE:			GET_CONFIG(AGL_DEPTH_SIZE);			return value;		case GLUT_WINDOW_RED_SIZE:			GET_CONFIG(AGL_RED_SIZE);			return value;		case GLUT_WINDOW_GREEN_SIZE:			GET_CONFIG(AGL_GREEN_SIZE);			return value;		case GLUT_WINDOW_BLUE_SIZE:			GET_CONFIG(AGL_BLUE_SIZE);			return value;		case GLUT_WINDOW_ALPHA_SIZE:			GET_CONFIG(AGL_ALPHA_SIZE);			return value;		case GLUT_WINDOW_ACCUM_RED_SIZE:			GET_CONFIG(AGL_ACCUM_RED_SIZE);			return value;		case GLUT_WINDOW_ACCUM_GREEN_SIZE:			GET_CONFIG(AGL_ACCUM_GREEN_SIZE);			return value;		case GLUT_WINDOW_ACCUM_BLUE_SIZE:			GET_CONFIG(AGL_ACCUM_BLUE_SIZE);			return value;		case GLUT_WINDOW_ACCUM_ALPHA_SIZE:			GET_CONFIG(AGL_ACCUM_ALPHA_SIZE);			return value;		case GLUT_WINDOW_DOUBLEBUFFER:			GET_CONFIG(AGL_DOUBLEBUFFER);			return value;		case GLUT_WINDOW_RGBA:			GET_CONFIG(AGL_RGBA);			return value;		case GLUT_WINDOW_COLORMAP_SIZE:			GET_CONFIG(AGL_RGBA);			if (value)				return 0;			GET_CONFIG(AGL_BUFFER_SIZE);			return 1 << value;		case GLUT_WINDOW_PARENT:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}						return __glutCurrentWindow->parent ? __glutCurrentWindow->parent->num + 1 : 0;		case GLUT_WINDOW_NUM_CHILDREN:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}						{				int num = 0;				GLUTwindow *children = __glutCurrentWindow->children;				while (children)				{					num++;					children = children->siblings;				}				return num;			}		case GLUT_WINDOW_NUM_SAMPLES:			return 0;		case GLUT_WINDOW_STEREO:			GET_CONFIG(AGL_STEREO);			return value;		case GLUT_WINDOW_CURSOR:			if(!__glutCurrentWindow)			{				__glutWarning("glutGet: no active window");				return -1;			}						return __glutCurrentWindow->cursor;		case GLUT_SCREEN_WIDTH:			if(__glutCurrentWindow && __glutGameModeWindow) return __glutCurrentWindow->width;#if TARGET_API_MAC_CARBON			GetRegionBounds(GetGrayRgn(), &screen_bounds);			return screen_bounds.right - screen_bounds.left;#else			return (qd.screenBits.bounds.right - qd.screenBits.bounds.left);#endif		case GLUT_SCREEN_HEIGHT:			if(__glutCurrentWindow && __glutGameModeWindow) return __glutCurrentWindow->height;			#if TARGET_API_MAC_CARBON			GetRegionBounds(GetGrayRgn(), &screen_bounds);			return screen_bounds.bottom - screen_bounds.top;#else			return (qd.screenBits.bounds.bottom - qd.screenBits.bounds.top);#endif		case GLUT_SCREEN_WIDTH_MM:			if(__glutCurrentWindow && __glutGameModeWindow) return __glutCurrentWindow->width;			#if TARGET_API_MAC_CARBON			GetRegionBounds(GetGrayRgn(), &screen_bounds);			return screen_bounds.right - screen_bounds.left;#else			return (qd.screenBits.bounds.right - qd.screenBits.bounds.left);#endif		case GLUT_SCREEN_HEIGHT_MM:			if(__glutCurrentWindow && __glutGameModeWindow) return __glutCurrentWindow->height;			#if TARGET_API_MAC_CARBON			GetRegionBounds(GetGrayRgn(), &screen_bounds);			return screen_bounds.bottom - screen_bounds.top;#else			return (qd.screenBits.bounds.bottom - qd.screenBits.bounds.top);#endif		case GLUT_MENU_NUM_ITEMS:			return __glutGetCurNumMenuItems();		case GLUT_DISPLAY_MODE_POSSIBLE:			{				AGLPixelFormat vi;				Bool dummy;				if(__glutDisplayString)				{					vi = __glutVisualInfoFromString(__glutDisplayString);				}				else				{					vi = __glutDetermineVisual(__glutDisplayMode, &dummy, __glutGetVisualInfo);				}				// vi = __glutDetermineVisual(__glutDisplayMode, &dummy, __glutGetVisualInfo);				if(vi)				{					aglDestroyPixelFormat(vi);					return 1;				}				return 0;			}		case GLUT_ELAPSED_TIME:			{				double beginning;				__glutInitTime(&beginning);				return (int) (__glutTime() - beginning);			}		case GLUT_WINDOW_FORMAT_ID:			return (int) __glutCurrentWindow->vis;		default:			__glutWarning("invalid glutGet parameter: %d", param);			return -1;	}		return -1;}